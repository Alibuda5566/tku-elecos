<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TKU ELECOS</title>
  <link rel="stylesheet" href="static/style.css">
  <script type="text/javascript" src="static/jquery-3.1.0.min.js"></script>
  <script type="text/javascript" src="static/vue.min.js"></script>
  <script type="text/javascript" src="static/vue.drag-and-drop.js"></script>
  <script type="text/javascript" src="data/courses.json"></script>
</head>
<body>
  <div id="vue-root">
    <div class="filters">
      <select v-model="select_group">
        <option v-for="group in groups" :value="group">${group[1]}</option>
      </select>
      <select v-if="select_group" v-model="select_dept">
        <option v-for="dept in select_group[2]" :value="dept">${dept[1]}</option>
      </select>
      <select v-if="select_group" v-model="select_term">
        <option :value="0" selected>第一學期</option>
        <option :value="1">第二學期</option>
      </select>
    </div>
    <div class="selected-list">
      <div class="title" v-if="selected.required.length">R:期望課程（按順序權重）</div>
      <div class="labels" v-if="selected.required.length">
        <div class="label" v-for="course in selected.required" :id="$index" v-drag-and-drop drop="handle_drop">
          ${course.name}
          <div class="remove" @click="remove_course(course,selected.required)">X</div>
        </div>
      </div>
      <div class="title" v-if="selected.optional.length">O:可選課程（按順序權重）</div>
      <div class="labels" v-if="selected.optional.length">
        <div class="label" v-for="course in selected.optional" :id="$index" v-drag-and-drop drop="handle_drop">
          ${course.name}
          <div class="remove" @click="remove_course(course,selected.optional)">X</div>
        </div>
      </div>
      <div>
        <div class="button" @click="arrange_selected()">排課</div>
        <div class="button" @click="clear_selected()">清除所有</div>
      </div>
    </div>
    <div v-if="arranged.length" class="arranged-list">
      <select v-model="selected_arranged">
        <option v-for="a in arranged" :value="a">${$index}</option>
      </select>
      <div v-if="selected_arranged">
        <table>
          <thead><tr><th></th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th><th>日</th></tr></thead>
          <tbody>
            <tr v-for="i in 15">
              <th>${i+1}</th>
              <td v-for="w in 7" :index="(w+1)*100+i+1">
                <div class="lesson" v-for="l in index_filter(selected_arranged,(w+1)*100+i+1)" :style={color:hashcolor(l.no)}>
                  ${l.name}
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="courses_list" v-if="select_group && select_dept && select_term != undefined">
      <div class="actions">
        <div v-if="select_dept && select_term != undefined" class="button" @click="add_dept(select_dept[2],select_term)">添加所有</div>
        <div v-if="select_dept && select_term != undefined" class="button" @click="add_dept(select_dept[2],select_term,true)">添加必修</div>
      </div>
      <table>
          <thead>
            <tr>
              <th></th>
              <th>序號</th>
              <th>科目</th>
              <th>年級</th>
              <th>名稱</th>
              <th>學分</th>
              <th>教師</th>
              <th>課時</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="course in select_dept[2]" v-if="course.term == select_term" :class="{'obligatory': course.obligatory, 'selected': is_selected(course)}">
              <td class="actions">
                <div :class="{hidden:is_selected(course,selected.required)}" class="button icon" @click="add_course(course,selected.required)">r</div>
                <div :class="{hidden:is_selected(course,selected.optional)}" class="button icon" @click="add_course(course,selected.optional)">o</div>
              </td>
              <td>${course.no}</td>
              <td>${course.subject}</td>
              <td>${GRADES[course.grade]}</td>
              <td>${course.name}</td>
              <td>${course.credit}</td>
              <td>${course.teacher}</td>
              <td>
                <span v-for="ct in course.classtime" style="margin:0 0.3em" :style="{opacity:ct.lab?0.5:1}">${ct.index}</span>
              </td>
            </tr>
          </tbody>
      </table>
    </div>
  </div>
</body>
<script type="text/javascript" src="static/index.js"></script>
</html>
